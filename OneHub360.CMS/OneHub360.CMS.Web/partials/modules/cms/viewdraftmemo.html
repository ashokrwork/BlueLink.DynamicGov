<div ng-controller="viewDraftMemoController" class="container" ng-init="LoadMemo(false)">
    <div ng-if="status == 0">
        <loading></loading>
    </div>
    <div class="mailDetailBox" ng-if="status == 1">
        <div class="row clearfix">
            <div class="col-lg-12 col-sm-12 col-md-12">
                <div class="card">
                    <div class="body">
                        <div class=" block-header">
                            <div class="row">
                                <div class="col-lg-2 col-md-2 col-sm-2">
                                    <h2>مسودة مذكرة</h2>
                                    <ul class="breadcrumb p-l-0 p-b-0 ">
                                        <li class="breadcrumb-item"><a href="index.html"><i class="icon-home"></i></a></li>
                                        <li class="breadcrumb-item" ui-sref="feed({option:'0'})">المسودات</li>
                                        <li class="breadcrumb-item active">مسودة مذكرة</li>
                                    </ul>
                                </div>


                                <div class="col-lg-10 col-md-10 col-sm-10" ng-controller="memoActions"
                                     ng-init="InitForDraft(Id)" data-intro="الوظائف التي من الممكن إتخاذها علي الكتاب" data-position="bottom">
                                    <button class="btn btn-success  float-right btn-sm hidden-xs m-l-10" ng-href="{{downloadUrl}}" target="_self"><i class="fa fa-download"></i> تنزيل</button>
                                    <button class="btn btn-success float-right btn-sm hidden-xs m-l-10" ng-click="sendDraftMemo()"><i class="fa fa-paper-plane" aria-hidden="true"></i><span ng-bind="sendTitle"></span></button>

                                    <feed-Comment threadid="{{memoData.ThreadId}}"></feed-Comment>
                                    <feed-Share feeditemid="{{Id}}"></feed-Share>

                                    <button class="btn btn-info float-right btn-sm hidden-xs m-l-10" ui-sref="Modal.editdraftmemomultisend({id:'{{Id}}'})"><i class="fa fa-users" aria-hidden="true"></i> متعدد ونسخة إلي ({{AddtionalToCount}}) ({{CopyToCount}})</button>

                                    <!--<a ng-click="PrintDraftMemo()"><i class="fa fa-print"></i> طباعة</a>-->





                                    <button class="btn btn-default  float-right btn-sm hidden-xs m-l-10" ng-if="isIE" target="_blank" ng-click="PrintDocument()"><i class="fa fa-print"></i> طباعة</button>



                                </div>





                            </div>
                        </div>


                    </div>
                </div>
            </div>
        </div>

        <div class="row clearfix">
            <div class="col-lg-8 col-md-8 col-sm-8">
                <div id="viewContainer" class="card">
                    <div class="header">
                        <h2><i class="fa fa-pencil-square-o"></i> {{memoData.Subject}}</h2>
                        <ul class="header-dropdown">
                            <li>
                                <a style="color:#9e9e9e" ui-sref="Modal.editdraftmemo({id:'{{Id}}'})"><i class="fa fa-pencil-square-o"></i></a>
                            </li>
                            <li>
                                <a style="color:#9e9e9e" ng-click="LoadMemo(false)"><i class="icon-refresh"></i></a>
                            </li>
                            <li>
                                <a style="color:#9e9e9e" onclick="toggleFullScreen('viewContainer')"><i class="icon-size-fullscreen"></i></a>
                            </li>

                        </ul>
                    </div>
                    <div class="body">
                        <ul class="nav nav-tabs">
                            <li class="nav-item"><a id="documenttab" class="nav-link active" data-toggle="tab" href="#document">عرض الوثائق</a></li>
                            <li class="nav-item"><a id="actionstab" class="nav-link" data-toggle="tab" href="#actions">عرض الإجراءات</a></li>

                        </ul>
                        <div class="tab-content">
                            <div role="tabpanel" class="tab-pane active" id="document">
                                <div ng-if="CurrentDocument.IsWebViewable" data-intro="عرض الوثيقة أو المرفق" data-position="top">
                                    <iframe height="800" width="100%" id="documentViewFrame" ng-if="CurrentDocument.ViewElement == 'iframe'"
                                            frameborder='0' ng-src="{{CurrentDocument.ViewUrl}}"></iframe>
                                    <img width="100%" ng-if="CurrentDocument.ViewElement == 'image'" ng-src="{{CurrentDocument.ViewUrl}}" />
                                </div>
                                <div ng-if="!CurrentDocument.IsWebViewable" data-intro="عرض الوثيقة أو المرفق" data-position="top">
                                    <h3>لا يمكن عرض هذا الملف من خلال النظام, يرجي الضغط علي الرابط أدناه لتنزيل الملف</h3>
                                    <a ng-href="{{CurrentDocument.ViewUrl}}"><i class="fa fa-download" aria-hidden="true"></i> تنزيل الملف</a>
                                </div>
                            </div>
                            <div role="tabpanel" class="tab-pane" id="actions">
                                <feed-Actions threadid="{{memoData.ThreadId}}"></feed-Actions>
                            </div>
                        </div>
                    </div>

                </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4">
                <div class="card">
                    <div class="header">
                        <h2><i class="fa fa-paperclip"></i> الوثائق</h2>
                    </div>
                    <div class="body">
                        <div class="docAttachments" data-intro="مرفقات الكتاب" data-position="bottom">

                            <div class="alert alert-success" role="alert">
                                <div class="container">
                                    <div class="alert-icon">
                                        <i class="fa fa-file-word-o"></i>
                                    </div>&nbsp;&nbsp;
                                    <a ng-click="ShowDocumentMainDocument()" data-intro="مطالعة الوثيقة الرئيسية" data-position="top">
                                        الوثيقة الرئيسية
                                    </a>

                                </div>
                            </div>


                            <div class="alert alert-info" id="{{attachement.Id}}" role="alert" ng-repeat="attachement in attachmentsData track by $index">
                                <div class="container">
                                    <div class="alert-icon">
                                        <i ng-class="attachement.FileIcon"></i>
                                    </div>&nbsp;&nbsp;
                                    <span ng-click="ShowAttachement(attachement)">{{attachement.Title}}</span>
                                    <span class="IconWhite" data-toggle="confirmation" data-title="سيتم حذف الملف, متابعة؟" ng-click="DeleteAttachement(attachement.Id)">
                                        <i class="fa fa-times"></i>
                                    </span>

                                </div>
                            </div>

                            <!--<div ng-repeat="attachement in attachmentsData track by $index">
                                <div class="attachItemBox">

                                    <span ng-click="ShowAttachement(attachement)" class="attachItemTitle"> <i ng-class="attachement.FileIcon" aria-hidden="true"></i> {{attachement.Title}}</span>
                                    <span class="IconRed" data-toggle="confirmation" data-title="سيتم حذف الملف, متابعة؟" ng-click="DeleteAttachement(attachement.Id)">
                                        <i class="fa fa-times"></i>
                                    </span>
                                </div>
                            </div>-->
                            <hr />
                            <div class="alert alert-warning" role="alert" ng-if="attachmentsData.length == 0">
                                <div class="container">
                                    <div class="alert-icon">
                                        <i class="fa fa-paperclip"></i>
                                    </div>&nbsp;&nbsp;
                                    لا يوجد مرفقات للمراسلة

                                </div>
                            </div>
                        </div>
                        <div class="docAttachments">
                            <i class="fa fa-plus"></i> إضافة مرفق
                            <div>
                                <br />
                                <div ng-if="Uploading">
                                    <loading></loading>
                                </div>
                                <div ngf-no-file-drop>File Drag/Drop is not supported for this browser</div>

                                <div ng-if="!Uploading" data-intro="إضافة مرفق جديد" data-position="top">
                                    <div ngf-drop="selectAttachement($file)" ngf-select="selectAttachement($file)" ng-model="file" name="file" class="drop-box">إسحب ملف هنا أو إضغط للإختيار</div>
                                    <div ng-click="openFromOneDrive()" style="text-align:center" class="drop-box">
                                        <img src="/img/modules/cms/OneDrive.png" width="170" />
                                    </div>
                                    <div class="drop-box" ng-if="isIE">
                                        <iframe style="width:200px!important;height:30px!important;border:0px!important" ng-src="{{ScanAppLink}}" />
                                    </div>
                                    <div class="drop-box" ng-if="!isIE">
                                        وظيفة المسح الضوئي تتطلب العمل من خلال برنامج MS Internet Explorer
                                    </div>
                                    <div class="input-group" ng-hide="attachementFile == null">
                                        <span class="input-group-addon" ng-click="UploadAttachement()">
                                            <i class="fa fa-upload" aria-hidden="true"></i>
                                        </span>
                                        
                                        <input ng-keyup="ValidateFileName($event)" type="text" ng-model="attachementFile.title" ng-required="true" class="form-control" placeholder="عنوان الملف">

                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>



    </div>

    

</div>